#!/bin/bash

SSID=$1

if [[ -z $SSID ]]; then
    echo Usage: $0 SSID
    exit 1
fi

# Create the monitor interface and bring it up.
ip link set wlan0 down
iwconfig wlan0 mode monitor || exit 1
ip link set wlan0 up

coproc DUMP {
    tcpdump -l -i wlan0 "(type mgt subtype beacon)" 2>/dev/null
}

# Wait for the first beacon frame from the given SSID.
wait-line "($SSID)" <&${DUMP[0]}
